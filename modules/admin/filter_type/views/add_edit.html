<div class="container-fluid" id="main-container">
	<div class="row clearfix" >
		<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
			<div class="card">
				<div class="header">
					<h2>
						<%= (is_editable) ? __("Filter Type Management Edit") : __("Filter Type Management Add"); %>
					</h2>
					<ul class="header-dropdown m-r--5 btn-right-top-margin">
						<li>
							<a href="<%=admin_list_url%>" >
								<button type="button" class="btn bg-indigo waves-effect">
									<i class="material-icons font-14">keyboard_backspace</i> <%= __("admin.system.back"); %>
								</button>
							</a>
						</li>
					</ul>
				</div>
				<%	
					var oldImage    =   (result.image)     ? result.image      :''; 
					var image       =   (result[IMAGE_FIELD_NAME])  ? result[IMAGE_FIELD_NAME]    :ADD_PROFILE_IMAGE_ICON;
				%>
				<div class="body">
					<form id="add-pricing-packages" data-submit-btn-id="pricing-packages-add-btn-id" method="post" class="on_click_submit" role="form">
						<div class="row clearfix">
							<div class="col-sm-12 align-center">
								<div class="form-group add-image">
									<input name="old_image" id="old_image" type="hidden" class="form-control"  value="<%=oldImage %>"/>
									<input name="image" id="image" class="form-control image-input-file" type="file"/>
									<span class="help-inline required profile_image" id="ContentTypeNameSpan">
										<div id="pImage">
											<img src="<%=image%>" alt="image" class="profileImage" />
										</div>
									</span>
									<div class="m-t-10">
										<a href="javascript:void(0)" data-toggle="tooltip" data-placement="bottom" title="<%= __("admin.system.allowed_file_extension") + ALLOWED_IMAGE_EXTENSIONS%>" class="btn bg-teal btn-block btn-sm waves-effect changePhoto">
											<%= __("admin.user.upload_image"); %>
										</a>
									</div>
									<span id="image_error" class="error"></span>
								</div>
							</div>
						</div>
						<div class="row clearfix">
							<div class="col-sm-6">
								<div class="form-group">
									<div class="form-line">
										<label for="name" class="control-label">
											<%= __("Name"); %><span class="required"> * </span>
										</label>
										<input type="text" id="name" class="form-control" name="name" value="<%=(result.name) ? result.name :''%>"/>
									</div>
									<span id="name_error" class="error"></span>
								</div>
							</div>
						

							<div class="col-sm-6">
								<div class="form-group">
									<div class="form-line">
										<label for="category" class="control-label">
											Category<span class="required"> * </span>
										</label>
										<select class="form-control show-tick search_by_status" id="category" name="category">
											<option value="">Select shedule type</option>
											<%
											selectSheduleCategory 		= 	(result.category)  ? String(result.category) :"";
											if(categoryList && categoryList.length > 0){
												categoryList.map(category =>{  
												var selectedFlag    = (typeof category.id !== typeof undefined && category.id  && category.id == selectSheduleCategory) ? "selected" : "";
												%>
												<option value="<%=category.id%>" <%=selectedFlag%> ><%=category.name%></option>
											<%      
												});
											} %>
										</select>
									</div>
									<span id="category_error" class="error"></span>
								</div>
							</div>
						</div>

						<div class="row clearfix">
							<div class="col-sm-6">
								<div class="form-group">
									<div class="form-line">
										<label for="shedules_category" class="control-label">
											Sub Category<span class="required"> * </span>
										</label>
										<select class="form-control" name="sub_category" id="sub_category" class="sub_category">
											<option value="">Select sub category</option>
										</select>
										
									</div>
									<span id="sub_category_error" class="error"></span>
								</div>
							</div>
						</div>

						
						

						<button type="button" id="pricing-packages-add-btn-id" class="btn bg-pink btn-sm waves-effect btn-submit" <%- ADMIN_LOADING_TEXT %> ><i class="material-icons font-14">save</i> <%= __("admin.system.submit"); %></button>
						<a href="javascript:location.reload(true);" class="text-decoration-none"><button type="button" class="btn bg-blue-grey btn-sm waves-effect"><i class="material-icons font-14">refresh</i> <%= __("admin.system.reset"); %></button></a>
						<a href="<%= admin_list_url %>"><button type="button" class="btn bg-brown btn-sm waves-effect"><i class="material-icons font-14">cancel</i><%= __("admin.system.cancel"); %></button></a>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>

<%- contentFor('css') %>
<link rel="stylesheet" href="https://cdn.rawgit.com/Eonasdan/bootstrap-datetimepicker/e8bddc60e73c1ec2475f827be36e1957af72e2ea/build/css/bootstrap-datetimepicker.css">
<link rel="stylesheet" href="<%= WEBSITE_ADMIN_JS_PLUGIN_PATH%>select2/css/select2.min.css">

<style>
.input-group-addon {
    padding: 0px 0px;
    font-size: 27px;
	background-color: #eee!important;
	padding: 6px 12px!important;
}
</style>

<%- contentFor("script") %>
<script type="text/javascript" src="https://cdn.rawgit.com/Eonasdan/bootstrap-datetimepicker/e8bddc60e73c1ec2475f827be36e1957af72e2ea/src/js/bootstrap-datetimepicker.js"></script>


<script src="<%= WEBSITE_ADMIN_JS_PLUGIN_PATH%>select2/js/select2.min.js"></script>


<script type="text/javascript">
	/**
	 * Function to submit form
	 */
	$('.btn-submit').click(function(){
		var btnId = $(this).attr('id');
		startTextLoading(btnId);
		ajax_submit('add-pricing-packages',function(status,response){
			if(status){
				window.location.href = response.redirect_url;
			}else{
				stopTextLoading(btnId);
			}
		});
	});


	/** Get States */
	$(document).ready(function () {
    	$("#category").on("change", function (e) {
			 var categoryId = $("#category").find(":selected").val();
			// var stateId = e.target.value;
			//getMastersSubCategoryList(categoryId);
			$.ajax({
				url: WEBSITE_ADMIN_URL+"region/category/get_subcategory",
				type: "POST",
				data: { category_id: categoryId },
				success: function (response) {
					/**States list*/
					var responseData = response.final_html_data[0] ? response.final_html_data[0] : "";
					console.log(responseData)
					$("select.sub_category").html("");
					$("#sub_category").html(responseData);
				},
			});


    	});
		$("#sub_category").select2( {
			placeholder: "Select SubCategory",
			allowClear: true
		});

		/**
		 * User image Upload
		 */
		$(document).on("click", ".changePhoto", function(){
			if(!$(".add-image #image").hasClass("added")){
				$(".add-image #image").trigger("click");
				$(".add-image #image").addClass("added");
				window.setTimeout(function(){
					$(".add-image #image").removeClass("added");
				},500);
			}
		});

		/**
		 *Show user image after select
		*/
		$("#image").on("change", function(){
			var files = !!this.files ? this.files : [];
			if (!files.length || !window.FileReader) return; // no file selected, or no FileReader support

			if (/^image/.test( files[0].type)){
				// only image file
				var reader = new FileReader(); // instance of the FileReader
				reader.readAsDataURL(files[0]); // read the local file
				reader.onloadend = function(){

					$("#pImage").html("<img src='"+this.result+"' class='profileImage' >");
				}
			}
			$("span#image_error").text("");
		});


    });
</script>
